<!DOCTYPE html>
<html>
<head>
    <title>{{ employee.name }} - @{{employee.email}}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    {% include 'navbar.html' %}
    <h1>{{ employee.name }}</h1>
    <h2>@{{ employee.email }}</h2>

    <div class="employee-profile">
        <div>
            {% if employee.picture_url %}
                <img src="{{ employee.picture_url }}" alt="Picture of {{ employee.name }}" class="employee-picture">
            {% else %}
                <p>No picture available.</p>
            {% endif %}
        </div>
        <div class="employee-info">
            <p><strong>Name:</strong> {{ employee.name }}</p>
            <p><strong>Title:</strong> {{ employee.title }}</p>
            <p><strong>Department:</strong>     <a href="{{ url_for('list_employees_by_department', department_name=employee.department) }}">
                {{ employee.department }}
            </a></p>
            <p><strong>Phone:</strong> {{ employee.phone or 'N/A' }}</p>
            <!-- Add any other information here -->
        </div>
    </div>

    {% if manager_chain %}
    <div class="relation-section">
        <h2>Management Chain</h2>
        {% for manager in manager_chain %}
            <div class="relation-item">
                <div class="small-employee-picture-container" style="background-image: url('{{ manager.picture_url }}');"></div>
                <div class="info-section">
                    <div class="name-section">
                        <a href="{{ url_for('view_employee', id=manager.id) }}">{{ manager.name }}</a>
                    </div>
                    <div class="title-section">
                        {{ manager.title }}
                    </div>
                    <div class="department-section">
                        {{ manager.department }}
                    </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <p>This employee does not report to anyone.</p>
{% endif %}

<div class="relation-section">
        <div class="relation-item">
            <div class="small-employee-picture-container" style="background-image: url('{{ employee.picture_url }}');"></div>
            <div class="info-section">
                <div class="name-section">
                    <a href="{{ url_for('view_employee', id=employee.id) }}">{{ employee.name }}</a>
                </div>
                <div class="title-section">
                    {{ employee.title }}
                </div>
                <div class="department-section">
                    {{ employee.department }}
                </div>
            </div>
        </div>
</div>

<div class="relation-section">
    <h2>Direct Reports</h2>
    {% if subordinates %}
        <ul>
            {% for subordinate in subordinates %}
            <li class="relation-item">
                <div class="small-employee-picture-container" style="background-image: url('{{ subordinate.picture_url }}');"></div>
                <div class="info-section">
                    <div class="name-section">
                        <a href="{{ url_for('view_employee', id=subordinate.id) }}">{{ subordinate.name }}</a>
                    </div>
                    <div class="title-section">
                        {{ subordinate.title }}
                    </div>
                    <div class="department-section">
                        {{ subordinate.department }}
                    </div>
                </div>
            </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>{{ employee.name }} does not have any direct reports.</p>
    {% endif %}
</div>

<h1>Gallery</h1>
<div class="gallery">
    <div id="image-container" style="max-width: 500px; max-height: 500px; overflow: hidden;">
        {% for image in images %}
        <img class="employee-image" src="{{ image.image_url }}" alt="Employee image" style="display: none; width: 100%; height: auto;">
        {% endfor %}
    </div>
    
    <script>
        let images = document.querySelectorAll('.employee-image');
        let currentImageIndex = 0;
    
        function showNextImage() {
            images[currentImageIndex].style.display = 'none';
            currentImageIndex = (currentImageIndex + 1) % images.length;
            images[currentImageIndex].style.display = 'block';
        }
    
        images[0].style.display = 'block';  // Show the first image initially
        setInterval(showNextImage, 5000);  // Change the image every 5 seconds
    </script>
</div>

<h1>Wall</h1>
{% for comment in comments %}
    <div class="comment-container">
        <a href="{{ url_for('view_employee', id=comment.author.id) }}">
            <img src="{{ comment.author.picture_url }}" alt="{{ comment.author.name }}">
        </a>
        <div class="comment-content">
            <p><strong><a href="{{ url_for('view_employee', id=comment.author.id) }}">{{ comment.author.name }}</a></strong></p>
            <p>{{ comment.timestamp.strftime('%B %d, %Y at %I:%M %p') }}</p>
            <p>{{ comment.content }}</p>
        </div>
    </div>
{% endfor %}

<h1>Post a Comment</h1>
<form action="{{ url_for('add_comment', id=employee.id) }}" method="post">
    <div class="comment-poster">
        <textarea name="content" required></textarea>
    </div>
    <input type="number" name="author_id" placeholder="Author ID" required>
    <input type="submit" value="Post Comment">
</form>
<br/>

<a href="{{ url_for('add_image', id=employee.id) }}">Add Image</a>

    <!-- Add links to edit or go back to the employee list -->
    <p><a href="{{ url_for('edit_employee', id=employee.id) }}">Edit this employee</a></p>
    <p><a href="{{ url_for('list_employees') }}">Back to employee list</a></p>
</body>
</html>